<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4-HMM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="4-HMM_files/libs/clipboard/clipboard.min.js"></script>
<script src="4-HMM_files/libs/quarto-html/quarto.js"></script>
<script src="4-HMM_files/libs/quarto-html/popper.min.js"></script>
<script src="4-HMM_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="4-HMM_files/libs/quarto-html/anchor.min.js"></script>
<link href="4-HMM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="4-HMM_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="4-HMM_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="4-HMM_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="4-HMM_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">4-HMM</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="fitting-a-hmm" class="level2">
<h2 class="anchored" data-anchor-id="fitting-a-hmm">1- Fitting a HMM</h2>
<p>Behavioural states are associated with each trip location:</p>
<ul>
<li><p>state 1: resting on the water</p></li>
<li><p>state 2: foraging</p></li>
<li><p>state 3: travelling</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -82907.12</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Computing pseudo-residuals... DONE</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Decoding states sequence... DONE</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-14.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-15.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-16.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-17.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-18.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-19.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-20.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-21.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-22.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-23.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-24.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-25.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-26.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/HMM-27.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="calculating-proportions-of-each-state" class="level1">
<h1>2- Calculating proportions of each state</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lme4' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Matrix' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:spam':

    det</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'glmmTMB' was built under R version 4.1.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'kableExtra' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:fields':

    color.scale</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'DHARMa' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mycol<span class="ot">&lt;-</span><span class="fu">mako</span>(<span class="dv">2</span>,<span class="at">begin=</span><span class="fl">0.35</span>,<span class="at">end=</span><span class="fl">0.7</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"NewlyCreatedData"</span>,<span class="st">"all_loc_HMM.RData"</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>dat.prop<span class="ot">&lt;-</span>dat <span class="sc">%&gt;%</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID,site,trip.id,states) <span class="sc">%&gt;%</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">SumAct=</span><span class="fu">sum</span>(difftimemin),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">Count=</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'ID', 'site', 'trip.id'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>tot<span class="ot">&lt;-</span>dat <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(trip.id) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Tot=</span><span class="fu">sum</span>(difftimemin),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">DateEnd=</span> <span class="fu">max</span>(datetime))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>dat.prop.tot<span class="ot">&lt;-</span>dat.prop <span class="sc">%&gt;%</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">left_join</span>(tot,<span class="at">by=</span><span class="st">"trip.id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">PropAct=</span>SumAct<span class="sc">/</span>Tot,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">day=</span><span class="fu">as.numeric</span>(<span class="fu">as.Date</span>(DateEnd) <span class="sc">-</span> <span class="fu">as.Date</span>(<span class="st">"2022-08-10"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span><span class="fu">c</span>(<span class="st">"ID"</span>,<span class="st">"site"</span>,<span class="st">"trip.id"</span>,<span class="st">"day"</span>),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_from =</span> states,<span class="at">id_expand=</span>F,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">names_prefix =</span> <span class="st">"Act"</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">values_from =</span> PropAct,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">names_sep=</span><span class="st">"."</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">values_fill=</span><span class="dv">0</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>dat.id<span class="ot">&lt;-</span>dat.prop.tot <span class="sc">%&gt;%</span> </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(site,ID) <span class="sc">%&gt;%</span> </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>     <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"Act1"</span>,<span class="st">"Act2"</span>,<span class="st">"Act3"</span>), mean, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'site'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>dat.id</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        site     ID       Act1      Act2      Act3
1  Bass Rock  18201 0.14629298 0.2411828 0.6125242
2  Bass Rock  18203 0.24422167 0.2539011 0.5018772
3  Bass Rock  18204 0.27702225 0.2507923 0.4721855
4  Bass Rock  18211 0.20142474 0.2492069 0.5493683
5  Bass Rock  18224 0.29919606 0.2263119 0.4744920
6  Bass Rock  18225 0.23315294 0.2793309 0.4875161
7  Bass Rock  18227 0.14081350 0.1872074 0.6719791
8  Bass Rock  18240 0.06746032 0.3316239 0.6009158
9  Bass Rock  18264 0.27848190 0.2168378 0.5046803
10 Bass Rock  18268 0.19706312 0.2792200 0.5237169
11    Rouzic 222267 0.49852767 0.1470548 0.3544176
12    Rouzic 222269 0.30536699 0.2005309 0.4941021
13    Rouzic 222270 0.34957961 0.1968378 0.4535826
14    Rouzic 222271 0.59971867 0.1531049 0.2471764
15    Rouzic 222272 0.57149102 0.1997250 0.2287840
16    Rouzic 222273 0.39794123 0.1683990 0.4336597
17    Rouzic 222274 0.49093205 0.1397851 0.3692829
18    Rouzic 222275 0.38472727 0.3019104 0.3133624
19    Rouzic 222276 0.28797944 0.3265446 0.3854759
20    Rouzic 222277 0.25159863 0.2130153 0.5353860
21    Rouzic 222279 0.43810878 0.2229556 0.3389356
22    Rouzic 222280 0.38520331 0.2266384 0.3881583
23    Rouzic 222281 0.45510698 0.1148503 0.4300427</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sum.act<span class="ot">&lt;-</span> dat.id <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(site) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"Act1"</span>,<span class="st">"Act2"</span>,<span class="st">"Act3"</span>), </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">list</span>(<span class="at">mean=</span>mean,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">se=</span>std.error))) <span class="sc">%&gt;%</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round,<span class="at">digits=</span><span class="dv">3</span>))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>sum.act</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 7
  site      Act1_mean Act1_se Act2_mean Act2_se Act3_mean Act3_se
  &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 Bass Rock     0.209   0.023     0.252   0.012     0.54    0.021
2 Rouzic        0.417   0.029     0.201   0.017     0.382   0.025</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>daysx<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"10/08"</span>,<span class="st">"20/08"</span>,<span class="st">"30/08"</span>,<span class="st">"09/09"</span>,<span class="st">"19/09"</span>,<span class="st">"29/09"</span>,<span class="st">"09/10"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Separate each activity by colony</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>rouzic<span class="ot">&lt;-</span>dat.prop.tot <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(site<span class="sc">==</span><span class="st">"Rouzic"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">droplevels</span>()</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>bassrock<span class="ot">&lt;-</span>dat.prop.tot <span class="sc">%&gt;%</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(site<span class="sc">==</span><span class="st">"Bass Rock"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">droplevels</span>()</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">#create new dataframes for model predictions</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>newdatrouz<span class="ot">&lt;-</span><span class="fu">expand.grid</span>(<span class="at">site=</span><span class="fu">unique</span>(rouzic<span class="sc">$</span>site),</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">day=</span><span class="fu">seq</span>(<span class="fu">min</span>(rouzic<span class="sc">$</span>day),</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">max</span>(rouzic<span class="sc">$</span>day),<span class="dv">1</span>),</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ID=</span><span class="cn">NA</span>)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>newdatbass<span class="ot">&lt;-</span><span class="fu">expand.grid</span>(<span class="at">site=</span><span class="fu">unique</span>(bassrock<span class="sc">$</span>site),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">day=</span><span class="fu">seq</span>(<span class="fu">min</span>(bassrock<span class="sc">$</span>day),</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">max</span>(bassrock<span class="sc">$</span>day),<span class="dv">1</span>),</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ID=</span><span class="cn">NA</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat.prop.tot,<span class="fu">aes</span>(<span class="at">x=</span>day,<span class="at">y=</span>Act1,<span class="at">colour=</span>site))<span class="sc">+</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">alpha=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model for resting activities</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>rest.glmer.rouz<span class="ot">&lt;-</span><span class="fu">glmer</span>(<span class="fu">asin</span>(Act1) <span class="sc">~</span> day <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ID), <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> rouzic) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize, rho): non-integer #successes in a binomial
glm!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>rest.TMBglm.rouz<span class="ot">&lt;-</span><span class="fu">glmmTMB</span>(Act1 <span class="sc">~</span> day <span class="sc">+</span>  (<span class="dv">1</span><span class="sc">|</span>ID), </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> <span class="st">"nbinom2"</span>, <span class="at">ziformula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> rouzic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in glmmTMB(Act1 ~ day + (1 | ID), family = "nbinom2", ziformula = ~1, :
non-integer counts in a nbinom2 model</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in fitTMB(TMBStruc): Model convergence problem; false convergence (8).
See vignette('troubleshooting')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(rest.TMBglm.rouz))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(rest.TMBglm.rouz))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rest.TMBglm.rouz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          Act1 ~ day + (1 | ID)
Zero inflation:        ~1
Data: rouzic

     AIC      BIC   logLik deviance df.resid 
   365.2    382.9   -177.6    355.2      252 

Random effects:

Conditional model:
 Groups Name        Variance  Std.Dev. 
 ID     (Intercept) 1.743e-09 4.175e-05
Number of obs: 257, groups:  ID, 13

Dispersion parameter for nbinom2 family (): 2.09e+07 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.15154    0.32180  -3.578 0.000346 ***
day          0.01017    0.01077   0.945 0.344912    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Zero-inflation model:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)   -16.77     302.09  -0.056    0.956</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>rr<span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(rest.TMBglm.rouz,<span class="at">plot=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in asinh(z): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in asinh(z): NaNs produced

Warning in asinh(z): NaNs produced</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>rest.glmer.bass<span class="ot">&lt;-</span><span class="fu">glmer</span>(<span class="fu">asin</span>(Act1) <span class="sc">~</span> day <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ID), <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> bassrock) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize, rho): non-integer #successes in a binomial
glm!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>rest.TMBglm.bass<span class="ot">&lt;-</span><span class="fu">glmmTMB</span>(Act1 <span class="sc">~</span> day <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ID), <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> bassrock)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(rest.TMBglm.bass))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(rest.TMBglm.bass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rest.TMBglm.bass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial  ( logit )
Formula:          Act1 ~ day + (1 | ID)
Data: bassrock

     AIC      BIC   logLik deviance df.resid 
   326.7    337.9   -160.3    320.7      307 

Random effects:

Conditional model:
 Groups Name        Variance  Std.Dev. 
 ID     (Intercept) 1.482e-09 3.849e-05
Number of obs: 310, groups:  ID, 10

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.437740   0.255983  -5.617 1.95e-08 ***
day          0.005322   0.008642   0.616    0.538    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>newdatrouz<span class="sc">$</span>predrest<span class="ot">&lt;-</span><span class="fu">predict</span>(rest.TMBglm.rouz,<span class="at">se.fit=</span>T, <span class="at">re.form=</span><span class="cn">NA</span>,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">newdata=</span>newdatrouz,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>fit</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>newdatrouz<span class="sc">$</span>predrestSE<span class="ot">&lt;-</span><span class="fu">predict</span>(rest.TMBglm.rouz,<span class="at">se.fit=</span>T, <span class="at">re.form=</span><span class="cn">NA</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">newdata=</span>newdatrouz,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>se.fit</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>newdatbass<span class="sc">$</span>predrest<span class="ot">&lt;-</span><span class="fu">predict</span>(rest.TMBglm.bass,<span class="at">newdata=</span>newdatbass,<span class="at">se.fit=</span>T,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">re.form=</span><span class="cn">NA</span>, <span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>fit</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>newdatbass<span class="sc">$</span>predrestSE<span class="ot">&lt;-</span><span class="fu">predict</span>(rest.TMBglm.bass,<span class="at">newdata=</span>newdatbass,<span class="at">se.fit=</span>T,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">re.form=</span><span class="cn">NA</span>, <span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>se.fit</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Model for foraging activities</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat.prop.tot,<span class="fu">aes</span>(<span class="at">x=</span>day,<span class="at">y=</span>Act2,<span class="at">colour=</span>site))<span class="sc">+</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">alpha=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>forag.glmer.rouz<span class="ot">&lt;-</span><span class="fu">glmer</span>(Act2 <span class="sc">~</span> day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> rouzic) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize, rho): non-integer #successes in a binomial
glm!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>forag.TMBglm.rouz<span class="ot">&lt;-</span><span class="fu">glmmTMB</span>(Act2 <span class="sc">~</span> day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> rouzic) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(forag.TMBglm.rouz))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(forag.TMBglm.rouz))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forag.TMBglm.rouz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial  ( logit )
Formula:          Act2 ~ day + (1 | ID)
Data: rouzic

     AIC      BIC   logLik deviance df.resid 
   268.6    279.2   -131.3    262.6      254 

Random effects:

Conditional model:
 Groups Name        Variance  Std.Dev. 
 ID     (Intercept) 1.404e-09 3.747e-05
Number of obs: 257, groups:  ID, 13

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept) -1.098221   0.509166  -2.157    0.031 *
day         -0.008679   0.017764  -0.488    0.625  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>forag.glmer.bass<span class="ot">&lt;-</span><span class="fu">glmer</span>(<span class="fu">asin</span>(Act2) <span class="sc">~</span> day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> bassrock)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize, rho): non-integer #successes in a binomial
glm!</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>forag.TMBglm.bass<span class="ot">&lt;-</span><span class="fu">glmmTMB</span>(Act2 <span class="sc">~</span> day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> bassrock) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(forag.TMBglm.bass))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(forag.glmer.bass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forag.TMBglm.bass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial  ( logit )
Formula:          Act2 ~ day + (1 | ID)
Data: bassrock

     AIC      BIC   logLik deviance df.resid 
   348.4    359.6   -171.2    342.4      307 

Random effects:

Conditional model:
 Groups Name        Variance  Std.Dev. 
 ID     (Intercept) 7.935e-10 2.817e-05
Number of obs: 310, groups:  ID, 10

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.075395   0.238561  -4.508 6.55e-06 ***
day         -0.002968   0.008356  -0.355    0.722    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>newdatrouz<span class="sc">$</span>predfor<span class="ot">&lt;-</span><span class="fu">predict</span>(forag.TMBglm.rouz,<span class="at">newdata=</span>newdatrouz,<span class="at">se.fit=</span>T,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">re.form=</span><span class="cn">NA</span>,<span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>fit</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>newdatrouz<span class="sc">$</span>predforSE<span class="ot">&lt;-</span><span class="fu">predict</span>(forag.TMBglm.rouz,<span class="at">newdata=</span>newdatrouz,<span class="at">se.fit=</span>T,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">re.form=</span><span class="cn">NA</span>,<span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>se.fit</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>newdatbass<span class="sc">$</span>predfor<span class="ot">&lt;-</span><span class="fu">predict</span>(forag.TMBglm.bass,<span class="at">newdata=</span>newdatbass,<span class="at">se.fit=</span>T,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">re.form=</span><span class="cn">NA</span>,<span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>fit</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>newdatbass<span class="sc">$</span>predforSE<span class="ot">&lt;-</span><span class="fu">predict</span>(forag.TMBglm.bass,<span class="at">newdata=</span>newdatbass,<span class="at">se.fit=</span>T,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">re.form=</span><span class="cn">NA</span>,<span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>se.fit</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Model for flying activities</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat.prop.tot,<span class="fu">aes</span>(<span class="at">x=</span>day,<span class="at">y=</span>Act3,<span class="at">colour=</span>site))<span class="sc">+</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">alpha=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fly.glmer.rouz&lt;-glmer(asin(Act3) ~ day + (1 | ID), family = "binomial", </span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                         data = rouzic)  </span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>fly.TMBglm.rouz<span class="ot">&lt;-</span><span class="fu">glmmTMB</span>(Act3 <span class="sc">~</span> day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> rouzic) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(fly.TMBglm.rouz))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(fly.TMBglm.rouz))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fly.TMBglm.rouz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial  ( logit )
Formula:          Act3 ~ day + (1 | ID)
Data: rouzic

     AIC      BIC   logLik deviance df.resid 
   344.3    354.9   -169.1    338.3      254 

Random effects:

Conditional model:
 Groups Name        Variance  Std.Dev. 
 ID     (Intercept) 8.015e-10 2.831e-05
Number of obs: 257, groups:  ID, 13

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -0.17476    0.42898  -0.407    0.684
day         -0.01278    0.01490  -0.857    0.391</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fly.glmer.bass&lt;-glmer(asin(Act3) ~ day + (1 | ID), family = "binomial", </span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                         data = bassrock)  </span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>fly.TMBglm.bass<span class="ot">&lt;-</span><span class="fu">glmmTMB</span>(Act3 <span class="sc">~</span> day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">family =</span> <span class="st">"binomial"</span>, </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> bassrock) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(fly.TMBglm.bass))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(fly.TMBglm.bass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-10.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fly.TMBglm.bass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial  ( logit )
Formula:          Act3 ~ day + (1 | ID)
Data: bassrock

     AIC      BIC   logLik deviance df.resid 
   433.1    444.3   -213.5    427.1      307 

Random effects:

Conditional model:
 Groups Name        Variance  Std.Dev. 
 ID     (Intercept) 3.792e-09 6.158e-05
Number of obs: 310, groups:  ID, 10

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)  0.218920   0.206835   1.058     0.29
day         -0.001439   0.007147  -0.201     0.84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>newdatrouz<span class="sc">$</span>predfly<span class="ot">&lt;-</span><span class="fu">predict</span>(fly.TMBglm.rouz,<span class="at">newdata=</span>newdatrouz,<span class="at">se.fit=</span>T,</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">re.form=</span><span class="cn">NA</span>,<span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>fit</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>newdatrouz<span class="sc">$</span>predflySE<span class="ot">&lt;-</span><span class="fu">predict</span>(fly.TMBglm.rouz,<span class="at">newdata=</span>newdatrouz,<span class="at">se.fit=</span>T,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">re.form=</span><span class="cn">NA</span>,<span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>se.fit</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>newdatbass<span class="sc">$</span>predfly<span class="ot">&lt;-</span><span class="fu">predict</span>(fly.TMBglm.bass,<span class="at">newdata=</span>newdatbass,<span class="at">se.fit=</span>T,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">re.form=</span><span class="cn">NA</span>,<span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>fit</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>newdatbass<span class="sc">$</span>predflySE<span class="ot">&lt;-</span><span class="fu">predict</span>(fly.TMBglm.bass,<span class="at">newdata=</span>newdatbass,<span class="at">se.fit=</span>T,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">re.form=</span><span class="cn">NA</span>,<span class="at">type=</span><span class="st">"response"</span>)<span class="sc">$</span>se.fit</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>newdatall<span class="ot">&lt;-</span><span class="fu">rbind</span>(newdatbass,newdatrouz)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>restgg<span class="ot">&lt;-</span><span class="fu">ggplot</span>(dat.prop.tot, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>Act1 ,<span class="at">colour=</span>site)) <span class="sc">+</span> </span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_line</span>(<span class="at">data=</span>newdatall,<span class="fu">aes</span>(<span class="at">x=</span>day,<span class="at">y=</span>predrest),<span class="at">lwd=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_ribbon</span>(<span class="at">data=</span> newdatall,</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">ymin=</span> predrest<span class="sc">-</span>predrestSE, </span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax=</span> predrest<span class="sc">+</span>predrestSE, <span class="at">y=</span> <span class="cn">NULL</span>,</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill=</span>site),</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha=</span><span class="fl">0.4</span>,<span class="at">colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Proportion of trip resting"</span>,<span class="at">tag=</span><span class="st">"a)"</span>,<span class="at">x=</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">64</span>),</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels=</span>daysx,</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">64</span>,<span class="dv">10</span>),</span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.001</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span>mycol) <span class="sc">+</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>mycol)  <span class="sc">+</span></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
i Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(restgg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-11.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>forgg<span class="ot">&lt;-</span><span class="fu">ggplot</span>(dat.prop.tot, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>Act2 ,<span class="at">colour=</span>site)) <span class="sc">+</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_line</span>(<span class="at">data=</span>newdatall,<span class="fu">aes</span>(<span class="at">x=</span>day,<span class="at">y=</span>predfor),<span class="at">lwd=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_ribbon</span>(<span class="at">data=</span> newdatall,</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">ymin=</span> predfor<span class="sc">-</span>predforSE, </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax=</span> predfor<span class="sc">+</span>predforSE, <span class="at">y=</span> <span class="cn">NULL</span>,</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill=</span>site),</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha=</span><span class="fl">0.4</span>,<span class="at">colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Proportion of trip foraging"</span>,<span class="at">tag=</span><span class="st">"b)"</span>,<span class="at">x=</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">64</span>),</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels=</span>daysx,</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">64</span>,<span class="dv">10</span>),</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.001</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span>mycol) <span class="sc">+</span></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>mycol)  <span class="sc">+</span></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>) </span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(forgg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-12.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>flygg<span class="ot">&lt;-</span><span class="fu">ggplot</span>(dat.prop.tot, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>Act3 ,<span class="at">colour=</span>site)) <span class="sc">+</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_line</span>(<span class="at">data=</span>newdatall,<span class="fu">aes</span>(<span class="at">x=</span>day,<span class="at">y=</span>predfly),<span class="at">lwd=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_ribbon</span>(<span class="at">data=</span> newdatall,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">ymin=</span> predfly<span class="sc">-</span>predflySE, </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax=</span> predfly<span class="sc">+</span>predflySE, <span class="at">y=</span> <span class="cn">NULL</span>,</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill=</span>site),</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha=</span><span class="fl">0.4</span>,<span class="at">colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Proportion of trip flying"</span>,<span class="at">tag=</span><span class="st">"c)"</span>,<span class="at">x=</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">64</span>),</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels=</span>daysx,</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">64</span>,<span class="dv">10</span>),</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.001</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>),</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span>mycol) <span class="sc">+</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>mycol) </span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(flygg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="4-HMM_files/figure-html/glmmTMB-13.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>mylegend<span class="ot">&lt;-</span><span class="fu">g_legend</span>(flygg)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tiff</span>(<span class="fu">here</span>(<span class="st">"outputs"</span>,<span class="st">"Figure_LMM_activities.tif"</span>),<span class="at">width=</span><span class="dv">7000</span>,<span class="at">height=</span><span class="dv">2000</span>,<span class="at">res=</span><span class="dv">600</span>,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">compression=</span><span class="st">"lzw"</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(restgg,forgg,</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>                         flygg<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>) ,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">ncol=</span><span class="dv">3</span>),</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>               mylegend, <span class="at">ncol=</span><span class="dv">2</span>,<span class="at">widths=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>)) </span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dev.off</span>()     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>